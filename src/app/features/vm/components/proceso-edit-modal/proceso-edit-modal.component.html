<div class="fixed inset-0 z-50 bg-black/40" (click)="closeByBackdrop()"></div>

<div class="fixed inset-0 z-50 grid place-items-center pointer-events-none">
  <div class="pointer-events-auto w-full max-w-xl rounded-2xl bg-white p-5 shadow-xl">
    <div class="flex items-start justify-between gap-4">
      <h3 class="text-lg font-semibold">Editar proceso</h3>
      <button class="text-gray-500 hover:text-gray-700" (click)="closed.emit()">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>

    <form class="mt-4 space-y-4" [formGroup]="form" (ngSubmit)="submit()">
      <div>
        <label class="block text-sm font-medium mb-1">Nombre</label>
        <input type="text" class="w-full rounded-lg border p-2" formControlName="nombre">
      </div>

      <div class="grid sm:grid-cols-2 gap-3">
        <div>
          <label class="block text-sm font-medium mb-1">Tipo de registro</label>
          <select class="w-full rounded-lg border p-2" formControlName="tipo_registro">
            <option value="HORAS">HORAS</option>
            <option value="ASISTENCIA">ASISTENCIA</option>
            <option value="EVALUACION">EVALUACION</option>
            <option value="MIXTO">MIXTO</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Orden</label>
          <input type="number" class="w-full rounded-lg border p-2" formControlName="orden" min="1">
        </div>
      </div>

      <div class="grid sm:grid-cols-2 gap-3">
        <div>
          <label class="block text-sm font-medium mb-1">Horas asignadas</label>
          <input type="number" class="w-full rounded-lg border p-2" formControlName="horas_asignadas" min="0">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Nota mínima</label>
          <input type="number" class="w-full rounded-lg border p-2" formControlName="nota_minima" min="0" max="100">
        </div>
      </div>

      <div class="flex items-center gap-2">
        <input id="reqAsist" type="checkbox" formControlName="requiere_asistencia" class="h-4 w-4 rounded border-gray-300">
        <label for="reqAsist" class="text-sm">Requiere asistencia</label>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Descripción</label>
        <textarea rows="3" class="w-full rounded-lg border p-2" formControlName="descripcion"></textarea>
      </div>

      <div *ngIf="serverError" class="text-sm text-red-600">{{ serverError }}</div>

      <div class="flex justify-end gap-2 pt-2">
        <button type="button" (click)="closed.emit()" class="px-4 py-2 rounded-lg border">Cancelar</button>
        <button type="submit" [disabled]="form.invalid || busy"
                class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60">
          <i *ngIf="busy" class="fa-solid fa-spinner fa-spin mr-2"></i>
          Guardar
        </button>
      </div>
    </form>
  </div>
</div>
