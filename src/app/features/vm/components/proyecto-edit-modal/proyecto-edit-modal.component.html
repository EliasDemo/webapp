<!-- Backdrop -->
<div class="fixed inset-0 z-50 bg-black/40" (click)="closeByBackdrop()"></div>

<!-- Modal -->
<div class="fixed inset-0 z-50 grid place-items-center pointer-events-none">
  <div class="pointer-events-auto w-full max-w-2xl rounded-2xl bg-white p-5 shadow-xl">
    <div class="flex items-start justify-between gap-4">
      <h3 class="text-lg font-semibold">Editar proyecto</h3>
      <button class="text-gray-500 hover:text-gray-700" (click)="closed.emit()">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>

    <form class="mt-4 space-y-4" (ngSubmit)="submit()" [formGroup]="form">
      <div>
        <label class="block text-sm font-medium mb-1">Título</label>
        <input type="text" class="w-full rounded-lg border p-2" formControlName="titulo">
      </div>

      <div class="grid sm:grid-cols-2 gap-3">
        <div>
          <label class="block text-sm font-medium mb-1">Código</label>
          <input type="text" class="w-full rounded-lg border p-2" formControlName="codigo">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Nivel</label>
          <input type="number" class="w-full rounded-lg border p-2" formControlName="nivel">
        </div>
      </div>

      <div class="grid sm:grid-cols-2 gap-3">
        <div>
          <label class="block text-sm font-medium mb-1">Tipo</label>
          <select class="w-full rounded-lg border p-2" formControlName="tipo">
            <option value="LIBRE">LIBRE</option>
            <option value="VINCULADO">VINCULADO</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Modalidad</label>
          <select class="w-full rounded-lg border p-2" formControlName="modalidad">
            <option value="PRESENCIAL">PRESENCIAL</option>
            <option value="VIRTUAL">VIRTUAL</option>
            <option value="MIXTA">MIXTA</option>
          </select>
        </div>
      </div>

      <div class="grid sm:grid-cols-2 gap-3">
        <div>
          <label class="block text-sm font-medium mb-1">Horas planificadas</label>
          <input type="number" class="w-full rounded-lg border p-2" formControlName="horas_planificadas" min="0">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Horas mín. participante</label>
          <input type="number" class="w-full rounded-lg border p-2" formControlName="horas_minimas_participante" min="0">
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Descripción</label>
        <textarea rows="3" class="w-full rounded-lg border p-2" formControlName="descripcion"></textarea>
      </div>

      <div *ngIf="serverError" class="text-sm text-red-600">{{ serverError }}</div>

      <div class="flex justify-end gap-2 pt-2">
        <button type="button" (click)="closed.emit()" class="px-4 py-2 rounded-lg border">Cancelar</button>
        <button type="submit" [disabled]="form.invalid || busy"
                class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60">
          <i *ngIf="busy" class="fa-solid fa-spinner fa-spin mr-2"></i>
          Guardar
        </button>
      </div>
    </form>
  </div>
</div>
